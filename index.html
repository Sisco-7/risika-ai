<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Risika AI</title>
    <link rel="icon" href="risika.png" sizes="32x32">
    <link rel="icon" href="risika.png" sizes="192x192">
    <link rel="apple-touch-icon" href="risika.png">
    <link rel="manifest" href="manifest.json">
    <meta name="theme-color" content="#2563eb">
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdn.jsdelivr.net/npm/dompurify@3.0.5/dist/purify.min.js"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-python.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-javascript.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-bash.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-json.min.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Plus+Jakarta+Sans:wght@300;400;500;600;700;800&family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            /* Light Theme - Enhanced Visibility */
            --bg-primary: #ffffff;
            --bg-secondary: rgba(255, 255, 255, 0.95);
            --bg-tertiary: rgba(248, 250, 252, 0.95);
            --bg-glass: rgba(255, 255, 255, 0.8);
            --accent-primary: #2563eb;
            --accent-secondary: #3b82f6;
            --accent-tertiary: #60a5fa;
            --accent-glow: rgba(37, 99, 235, 0.15);
            --text-primary: #0f172a;
            --text-secondary: #475569;
            --text-muted: #64748b;
            --border: rgba(226, 232, 240, 0.8);
            --border-accent: rgba(59, 130, 246, 0.4);
            --msg-user: linear-gradient(135deg, #2563eb, #3b82f6);
            --msg-ai: rgba(248, 250, 252, 0.95);
            --success: #10b981;
            --warning: #f59e0b;
            --error: #ef4444;
            --code-bg: #1e293b;
            --particle-color: #0f172a;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.05);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.1), 0 4px 6px -2px rgba(0, 0, 0, 0.05);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
            --blur-sm: blur(4px);
            --blur-md: blur(8px);
            --blur-lg: blur(16px);
        }

        .dark-mode {
            /* Dark Theme - Cyberpunk Glass */
            --bg-primary: #0a0e1a;
            --bg-secondary: rgba(15, 23, 42, 0.8);
            --bg-tertiary: rgba(30, 41, 59, 0.9);
            --bg-glass: rgba(15, 23, 42, 0.4);
            --accent-primary: #60a5fa;
            --accent-secondary: #3b82f6;
            --accent-tertiary: #1d4ed8;
            --accent-glow: rgba(96, 165, 250, 0.3);
            --text-primary: #f8fafc;
            --text-secondary: #cbd5e1;
            --text-muted: #94a3b8;
            --border: rgba(71, 85, 105, 0.4);
            --border-accent: rgba(96, 165, 250, 0.4);
            --msg-user: linear-gradient(135deg, #1e40af, #2563eb);
            --msg-ai: rgba(30, 41, 59, 0.9);
            --code-bg: #0f172a;
            --particle-color: #f8fafc;
            --shadow-sm: 0 1px 2px 0 rgba(0, 0, 0, 0.3);
            --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.4), 0 2px 4px -1px rgba(0, 0, 0, 0.3);
            --shadow-lg: 0 10px 15px -3px rgba(0, 0, 0, 0.5), 0 4px 6px -2px rgba(0, 0, 0, 0.4);
            --shadow-xl: 0 20px 25px -5px rgba(0, 0, 0, 0.6), 0 10px 10px -5px rgba(0, 0, 0, 0.5);
            --blur-sm: blur(4px);
            --blur-md: blur(8px);
            --blur-lg: blur(16px);
        }

        * {
            box-sizing: border-box;
        }

        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            margin: 0;
            padding: 0;
            height: 100vh;
            overflow: hidden;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            position: relative;
        }

        body::before {
            content: '';
            position: fixed;
            inset: 0;
            background: 
                radial-gradient(circle at 20% 80%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(circle at 80% 20%, var(--accent-glow) 0%, transparent 50%),
                radial-gradient(circle at 40% 40%, var(--accent-glow) 0%, transparent 50%);
            pointer-events: none;
            z-index: -1;
        }

        .splash-screen {
            position: fixed;
            inset: 0;
            background: 
                linear-gradient(135deg, rgba(37, 99, 235, 0.3), rgba(59, 130, 246, 0.2)),
                url('desktop-risika.jpg') center/cover no-repeat;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            z-index: 9999;
            transition: opacity 0.6s cubic-bezier(0.4, 0, 0.2, 1), transform 0.6s cubic-bezier(0.4, 0, 0.2, 1);
        }

        @media (max-width: 768px) {
            .splash-screen {
                background: 
                    linear-gradient(135deg, rgba(37, 99, 235, 0.3), rgba(59, 130, 246, 0.2)),
                    url('mobile-risika.jpg') center/cover no-repeat;
            }
        }

        .splash-screen.fade-out {
            opacity: 0;
            transform: scale(1.1);
        }

        .neural-logo {
            display: flex;
            align-items: center;
            justify-content: center;
            margin-bottom: 2rem;
            animation: logoFloat 3s ease-in-out infinite;
        }

        .neural-logo img {
            width: 80px;
            height: 80px;
            object-fit: contain;
        }

        .neural-connections {
            position: absolute;
            width: 200px;
            height: 200px;
            opacity: 0.3;
        }

        .neural-node {
            position: absolute;
            width: 4px;
            height: 4px;
            background: white;
            border-radius: 50%;
            animation: nodeGlow 3s infinite ease-in-out;
        }

        .neural-line {
            position: absolute;
            height: 1px;
            background: linear-gradient(90deg, transparent, white, transparent);
            animation: dataFlow 2s infinite linear;
        }

        .splash-title {
            color: white;
            font-size: 2rem;
            font-weight: 800;
            margin-bottom: 0.5rem;
            text-align: center;
        }

        .splash-subtitle {
            color: rgba(255, 255, 255, 0.9);
            font-size: 1rem;
            margin-bottom: 3rem;
            text-align: center;
            font-weight: 500;
        }

        .progress-container {
            width: 300px;
            height: 4px;
            background: rgba(255, 255, 255, 0.2);
            border-radius: 2px;
            overflow: hidden;
            margin-bottom: 1rem;
        }

        .progress-bar {
            height: 100%;
            background: linear-gradient(90deg, white, rgba(255, 255, 255, 0.8));
            border-radius: 2px;
            width: 0%;
            transition: width 0.3s ease;
            animation: shimmer 2s infinite;
        }

        .progress-text {
            color: rgba(255, 255, 255, 0.9);
            font-size: 0.8rem;
            text-align: center;
            font-weight: 500;
        }

        /* App Container */
        .app-container {
            display: flex;
            height: 100vh;
            width: 100vw;
            overflow: hidden;
            opacity: 0;
            transition: opacity 0.5s ease;
        }

        .app-container.visible {
            opacity: 1;
        }

        /* Sidebar */
        /* Glass Morphism Sidebar */
        #sidebar {
            width: 280px;
            flex-shrink: 0;
            background: var(--bg-glass);
            backdrop-filter: var(--blur-lg);
            border-right: 1px solid var(--border-accent);
            transition: transform 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            z-index: 50;
            overflow: hidden;
            box-shadow: var(--shadow-xl);
        }

        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            min-width: 0;
            background: var(--bg-glass);
            backdrop-filter: var(--blur-md);
            overflow: hidden;
        }

        /* Enhanced Cosmic Background */
        .cosmic-background {
            position: fixed;
            inset: 0;
            pointer-events: none;
            z-index: 1;
            overflow: hidden;
        }

        .cosmic-particle {
            position: absolute;
            border-radius: 50%;
        }

        .star {
            width: 2px;
            height: 2px;
            background: var(--particle-color);
            animation: starTwinkle 6s infinite ease-in-out, starFloat 15s infinite linear;
            box-shadow: 0 0 4px var(--particle-color);
            opacity: 0.8;
        }

        @keyframes starTwinkle {
            0%, 100% { opacity: 0.3; transform: scale(1); }
            50% { opacity: 1; transform: scale(1.4); }
        }
        
        @keyframes starFloat {
            0% { transform: translateY(0px) translateX(0px); }
            25% { transform: translateY(-20px) translateX(10px); }
            50% { transform: translateY(-10px) translateX(-15px); }
            75% { transform: translateY(-30px) translateX(5px); }
            100% { transform: translateY(0px) translateX(0px); }
        }

        /* Custom Scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }

        ::-webkit-scrollbar-track {
            background: var(--bg-glass);
            border-radius: 4px;
        }

        ::-webkit-scrollbar-thumb {
            background: var(--accent-primary);
            border-radius: 4px;
            transition: background 0.3s ease;
        }

        ::-webkit-scrollbar-thumb:hover {
            background: var(--accent-secondary);
        }

        /* Firefox */
        * {
            scrollbar-width: thin;
            scrollbar-color: var(--accent-primary) var(--bg-glass);
        }

        /* Message Styling */
        .msg-wrapper {
            display: flex;
            gap: 0.75rem;
            max-width: min(100%, 800px);
            margin: 0 auto;
            width: 100%;
            padding: 0 1rem;
            margin-bottom: 1rem;
        }

        .msg-content {
            flex: 1;
            min-width: 0;
        }

        .msg-bubble {
            padding: 0.75rem 1rem;
            border-radius: 1.25rem;
            line-height: 1.5;
            word-wrap: break-word;
            position: relative;
            font-size: 0.9rem;
        }

        .msg-user .msg-bubble {
            background: var(--msg-user);
            color: white;
            margin-left: auto;
            max-width: 85%;
            border-bottom-right-radius: 0.375rem;
            box-shadow: var(--shadow-md);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .msg-ai .msg-bubble {
            background: var(--msg-ai);
            backdrop-filter: var(--blur-sm);
            border: 1px solid var(--border-accent);
            color: var(--text-primary);
            border-bottom-left-radius: 0.375rem;
            box-shadow: var(--shadow-sm);
        }

        .msg-content {
            flex: 1;
            min-width: 0;
        }

        .msg-header {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--text-muted);
            margin-bottom: 0.5rem;
        }

        .msg-bubble {
            padding: 1rem 1.25rem;
            border-radius: 1.5rem;
            line-height: 1.6;
            word-wrap: break-word;
            position: relative;
        }

        .msg-user .msg-bubble {
            background: var(--msg-user);
            color: white;
            margin-left: auto;
            max-width: 80%;
            border-bottom-right-radius: 0.5rem;
            box-shadow: var(--shadow-lg);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .msg-ai .msg-bubble {
            background: var(--msg-ai);
            backdrop-filter: var(--blur-sm);
            border: 1px solid var(--border-accent);
            color: var(--text-primary);
            border-bottom-left-radius: 0.5rem;
            box-shadow: var(--shadow-md);
        }

        .msg-ai .msg-header::before {
            content: "ðŸ§ ";
            margin-right: 0.5rem;
        }

        /* File Upload Area */
        .file-upload-area {
            border: 2px dashed var(--border-accent);
            border-radius: 1.5rem;
            padding: 2rem;
            text-align: center;
            background: var(--bg-glass);
            backdrop-filter: var(--blur-md);
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            cursor: pointer;
        }

        .file-upload-area:hover {
            border-color: var(--accent-primary);
            background: var(--bg-secondary);
            transform: translateY(-2px);
            box-shadow: var(--shadow-lg);
        }

        .file-upload-area.dragover {
            border-color: var(--accent-primary);
            background: var(--accent-glow);
            transform: scale(1.02);
            box-shadow: var(--shadow-xl), 0 0 0 1px var(--accent-primary);
        }

        /* Animations */
        @keyframes logoFloat {
            0%, 100% { transform: translateY(0px) scale(1); }
            50% { transform: translateY(-10px) scale(1.05); }
        }

        @keyframes pulse {
            0%, 100% { transform: scale(1); opacity: 1; }
            50% { transform: scale(1.05); opacity: 0.9; }
        }

        @keyframes nodeGlow {
            0%, 100% { opacity: 0.3; }
            50% { opacity: 1; }
        }

        @keyframes dataFlow {
            0% { transform: translateX(-100%); }
            100% { transform: translateX(100%); }
        }

        @keyframes shimmer {
            0% { background-position: -300px 0; }
            100% { background-position: 300px 0; }
        }

        @keyframes float {
            0% { transform: translateY(100vh) translateX(0); }
            100% { transform: translateY(-100vh) translateX(100px); }
        }

        @keyframes slideIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .animate-slide-in {
            animation: slideIn 0.5s ease-out;
        }

        /* Responsive Design */
        /* Mobile Sidebar Overlay */
        .sidebar-overlay {
            position: fixed;
            inset: 0;
            background: rgba(0, 0, 0, 0.5);
            z-index: 40;
            opacity: 0;
            visibility: hidden;
            transition: all 0.3s ease;
        }
        
        .sidebar-overlay.active {
            opacity: 1;
            visibility: visible;
        }

        @media (max-width: 1024px) {
            #sidebar {
                position: fixed;
                left: 0;
                top: 0;
                bottom: 0;
                transform: translateX(-100%);
                width: 100%;
                max-width: 280px;
                z-index: 50;
            }
            #sidebar.open { transform: translateX(0); }
            .main-content { width: 100vw; }
            
            .msg-wrapper { padding: 0 0.75rem; }
            .msg-bubble { font-size: 0.85rem; padding: 0.625rem 0.875rem; }
            
            /* Ensure footer doesn't get blocked */
            footer {
                position: relative;
                z-index: 10;
                padding-bottom: calc(1rem + env(safe-area-inset-bottom, 0));
            }
        }

        @media (max-width: 640px) {
            .splash-title { font-size: 1.5rem; }
            .progress-container { width: 250px; }
            .msg-wrapper { padding: 0 0.5rem; }
            .msg-bubble { font-size: 0.8rem; }
            
            /* Better mobile header */
            header {
                padding: 0.75rem 1rem;
            }
            
            header h1 {
                font-size: 0.875rem;
                margin-bottom: 0.125rem;
            }
            
            header p {
                font-size: 0.75rem;
            }
        }

        /* Artifact Containers */
        .artifact-container {
            background: var(--bg-tertiary);
            border: 1px solid var(--border-accent);
            border-radius: 1rem;
            padding: 1.25rem;
            margin: 1rem 0;
            position: relative;
            overflow: hidden;
            box-shadow: var(--shadow-sm);
        }

        .artifact-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 1rem;
            padding-bottom: 0.75rem;
            border-bottom: 1px solid var(--border-accent);
        }

        .artifact-title {
            font-size: 0.75rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            color: var(--accent-primary);
        }

        .copy-btn {
            background: var(--accent-primary);
            color: white;
            border: none;
            border-radius: 0.5rem;
            padding: 0.5rem 1rem;
            font-size: 0.75rem;
            cursor: pointer;
            display: flex;
            align-items: center;
            gap: 0.25rem;
            transition: all 0.2s ease;
        }

        .copy-btn:hover {
            background: var(--accent-secondary);
            transform: translateY(-1px);
        }

        .copy-btn.success {
            background: var(--success);
        }

        /* Code Blocks */
        .artifact-content pre {
            background: var(--code-bg) !important;
            border-radius: 0.5rem;
            padding: 1rem !important;
            margin: 0.5rem 0;
            overflow-x: auto;
        }

        .artifact-content pre code {
            background: transparent !important;
            color: #f8f8f2;
            font-size: 0.85rem;
        }
    </style>
</head>
<body>
    <!-- Professional Splash Screen -->
    <div id="splash-screen" class="splash-screen">
        <div class="neural-connections">
            <div class="neural-node" style="top: 20%; left: 30%;"></div>
            <div class="neural-node" style="top: 40%; left: 70%;"></div>
            <div class="neural-node" style="top: 60%; left: 20%;"></div>
            <div class="neural-node" style="top: 80%; left: 60%;"></div>
            <div class="neural-line" style="top: 25%; left: 30%; width: 40%; transform: rotate(45deg);"></div>
            <div class="neural-line" style="top: 45%; left: 20%; width: 50%; transform: rotate(-30deg);"></div>
            <div class="neural-line" style="top: 65%; left: 40%; width: 30%; transform: rotate(60deg);"></div>
        </div>
        
        <div class="neural-logo">
            <img src="risika.png" alt="Risika AI Logo" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
            <i data-lucide="brain-circuit" class="w-12 h-12 text-white" style="display: none;"></i>
        </div>
        
        <h1 class="splash-title">Risika AI</h1>
        <p class="splash-subtitle">Your AI Assistant</p>
        
        <div class="progress-container">
            <div id="splash-progress" class="progress-bar"></div>
        </div>
        <p id="splash-status" class="progress-text">Loading AI Models...</p>
    </div>

    <!-- Neural Background Animation -->
    <div class="neural-background" id="neural-bg"></div>

    <!-- Cosmic Background -->
    <div class="cosmic-background" id="cosmic-bg"></div>

    <!-- Sidebar Overlay for Mobile -->
    <div id="sidebar-overlay" class="sidebar-overlay" onclick="closeSidebar()"></div>

    <!-- Main App Container -->
    <div id="app-container" class="app-container">
        <!-- Sidebar -->
        <aside id="sidebar" class="flex flex-col">
            <div class="p-6 flex flex-col h-full">
                <!-- Header -->
                <div class="flex items-center justify-between mb-4">
                    <div class="flex items-center gap-2">
                        <div class="w-10 h-10 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl flex items-center justify-center shadow-lg border border-white/20">
                            <img src="risika.png" alt="Risika AI" class="w-6 h-6 object-contain" onerror="this.style.display='none'; this.nextElementSibling.style.display='flex'">
                            <i data-lucide="brain-circuit" class="w-5 h-5 text-white" style="display: none;"></i>
                        </div>
                        <div>
                            <span class="font-bold text-sm bg-gradient-to-r from-blue-600 to-blue-800 bg-clip-text text-transparent">Risika AI</span>
                            <div class="flex items-center mt-0.5">
                                <div class="w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse mr-1.5 shadow-sm shadow-green-500/50"></div>
                                <span class="text-xs font-medium text-green-500">Online</span>
                            </div>
                        </div>
                    </div>
                    <div class="flex items-center gap-2">
                        <button onclick="showAbout()" class="p-2 hover:bg-white/10 rounded-lg transition-all duration-200 group" title="About">
                            <i data-lucide="info" class="w-4 h-4 text-gray-400 group-hover:text-blue-500"></i>
                        </button>
                        <button onclick="showFeedback()" class="p-2 hover:bg-white/10 rounded-lg transition-all duration-200 group" title="Feedback">
                            <i data-lucide="message-square" class="w-4 h-4 text-gray-400 group-hover:text-green-500"></i>
                        </button>
                    </div>
                </div>

                <!-- New Session Button -->
                <button onclick="newSession()" class="mb-4 w-full flex items-center justify-between p-3 rounded-xl bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 text-white shadow-lg hover:shadow-blue-500/25 transition-all duration-300 active:scale-95 border border-white/10">
                    <span class="text-sm font-semibold">New Chat</span>
                    <div class="w-5 h-5 bg-white/20 rounded-lg flex items-center justify-center">
                        <i data-lucide="plus" class="w-3 h-3"></i>
                    </div>
                </button>

                <!-- Session List -->
                <div class="flex-1 overflow-y-auto">
                    <div class="flex items-center justify-between mb-3">
                        <p class="text-xs font-semibold text-gray-500 uppercase tracking-wide">Recent Chats</p>
                        <button onclick="clearAllSessions()" class="text-xs font-medium text-red-400 hover:text-red-600 transition-colors">
                            <i data-lucide="trash-2" class="w-3 h-3"></i>
                        </button>
                    </div>
                    <div id="session-list" class="space-y-2"></div>
                </div>

                <!-- Theme Toggle -->
                <div class="mt-4 pt-4 border-t border-white/10">
                    <div class="flex items-center justify-center gap-1 p-1 bg-white/5 rounded-lg">
                        <button onclick="setTheme('light')" id="light-btn" class="flex-1 py-2 flex justify-center rounded-md transition-all">
                            <i data-lucide="sun" class="w-4 h-4"></i>
                        </button>
                        <button onclick="setTheme('dark')" id="dark-btn" class="flex-1 py-2 flex justify-center rounded-md transition-all">
                            <i data-lucide="moon" class="w-4 h-4"></i>
                        </button>
                    </div>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- Header -->
            <header class="h-16 flex items-center px-6 border-b border-white/20 bg-gradient-to-r from-blue-500/10 via-purple-500/5 to-blue-500/10 backdrop-blur-xl">
                <!-- Left Icons -->
                <div class="w-20 flex items-center">
                    <button onclick="toggleSidebar()" class="lg:hidden p-2 hover:bg-white/10 rounded-lg transition-all duration-200">
                        <i data-lucide="menu" class="w-5 h-5"></i>
                    </button>
                    <button onclick="closeSidebar()" class="lg:hidden p-2 hover:bg-white/10 rounded-lg transition-all duration-200" id="close-sidebar-btn" style="display: none;">
                        <i data-lucide="x" class="w-5 h-5"></i>
                    </button>
                </div>
                
                <!-- Center Subtle Branding -->
                <div class="flex-1 flex items-center justify-center">
                    <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse opacity-60"></div>
                    <div class="w-1 h-1 bg-purple-500 rounded-full animate-pulse mx-2 opacity-40" style="animation-delay: 0.5s"></div>
                    <div class="w-2 h-2 bg-blue-500 rounded-full animate-pulse opacity-60" style="animation-delay: 1s"></div>
                </div>
                
                <!-- Right Icons -->
                <div class="w-20 flex items-center justify-end">
                    <button onclick="exportChat()" class="p-2 hover:bg-white/10 rounded-lg transition-all duration-200 group">
                        <i data-lucide="download" class="w-4 h-4 group-hover:scale-110 transition-transform"></i>
                    </button>
                </div>
            </header>

            <!-- Chat Container -->
            <div id="chat-container" class="flex-1 overflow-y-auto p-6 space-y-6"></div>

            <!-- Footer -->
            <footer class="p-4 border-t border-white/10 bg-white/5 backdrop-blur-xl">
                <div class="max-w-4xl mx-auto">
                    <!-- File Upload Area -->
                    <div id="file-upload-area" class="file-upload-area hidden mb-4" onclick="document.getElementById('file-input').click()">
                        <div class="flex flex-col items-center gap-3">
                            <div class="w-12 h-12 bg-blue-500/20 rounded-xl flex items-center justify-center">
                                <i data-lucide="upload" class="w-6 h-6 text-blue-500"></i>
                            </div>
                            <div class="text-center">
                                <p class="text-sm font-semibold text-blue-600 mb-1">Drop files here or click to upload</p>
                                <p class="text-xs text-gray-500">Images, Documents, Code files â€¢ Max 10MB each</p>
                            </div>
                        </div>
                    </div>

                    <!-- Selected Files -->
                    <div id="selected-files" class="hidden mb-4 space-y-2"></div>

                    <!-- Input Container -->
                    <div class="relative bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl p-2 flex items-end gap-3 focus-within:border-blue-500/50 focus-within:bg-white/15 transition-all duration-300 shadow-lg">
                        <textarea 
                            id="message-input" 
                            rows="1" 
                            placeholder="Message Risika AI..." 
                            class="flex-1 bg-transparent border-none outline-none resize-none max-h-32 py-2 text-sm placeholder-gray-500"
                            style="color: var(--text-primary);"
                            onkeydown="handleKeyDown(event)"
                            oninput="autoResize(this)"></textarea>
                        
                        <button onclick="sendMessage()" id="send-btn" class="w-10 h-10 bg-gradient-to-r from-blue-500 via-blue-600 to-blue-700 text-white rounded-xl hover:shadow-lg hover:shadow-blue-500/25 transition-all duration-300 active:scale-95 flex items-center justify-center group border border-white/10">
                            <i data-lucide="send" class="w-4 h-4 group-hover:translate-x-0.5 transition-transform"></i>
                        </button>
                    </div>
                </div>
            </footer>
        </main>
    </div>

    <!-- Hidden File Input -->
    <input type="file" id="file-input" multiple accept="image/*,.pdf,.doc,.docx,.txt,.csv,.xlsx,.ppt,.pptx" style="display: none;" onchange="handleFileSelect(event)">

    <script>
        // Configuration - Multiple API providers with backups
        const CONFIG = {
            gemini: {
                key: "AIzaSyCWF90TpBpX2T7Zy82juBlpgKgOSE0Sc48",
                url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent"
            },
            geminiBackup: {
                key: "AIzaSyCWkyF19jwtJFcDRi9SXH-LUPHf0fjtMWQ",
                url: "https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash:generateContent"
            },
            groq: {
                key: "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",
                url: "https://api.groq.com/openai/v1/chat/completions",
                model: "llama-3.3-70b-versatile"
            },
            openrouter: {
                key: "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",
                url: "https://openrouter.ai/api/v1/chat/completions",
                model: "google/gemini-1.5-flash"
            }
        };

        // Global State
        let state = {
            sessions: JSON.parse(localStorage.getItem('risika_sessions') || '[]'),
            activeSessionId: localStorage.getItem('risika_active_session') || null,
            theme: localStorage.getItem('risika_theme') || 'light',
            selectedFiles: [],
            currentModel: 'gemini'
        };

        // Initialize App
        async function initApp() {
            // Show splash screen with progress
            await showSplashScreen();
            
            // Initialize theme
            setTheme(state.theme);
            
            // Create cosmic background
            createCosmicBackground();
            
            // Load session or create new one
            if (!state.activeSessionId || !state.sessions.find(s => s.id === state.activeSessionId)) {
                newSession();
            } else {
                loadSession(state.activeSessionId);
            }
            
            // Render sessions
            renderSessions();
            
            // Initialize icons
            lucide.createIcons();
            
            // Hide splash and show app
            hideSplashScreen();
            
            // Test connection after 1 second
            setTimeout(async () => {
                try {
                    updateConnectionStatus('connecting');
                    await callGemini([], 'test');
                    updateConnectionStatus('connected');
                } catch (error) {
                    updateConnectionStatus('disconnected');
                }
            }, 1000);
        }

        // Professional Splash Screen
        async function showSplashScreen() {
            const progressBar = document.getElementById('splash-progress');
            const statusText = document.getElementById('splash-status');
            
            const steps = [
                { progress: 20, text: 'Loading AI Models...' },
                { progress: 40, text: 'Initializing Neural Networks...' },
                { progress: 60, text: 'Establishing Secure Connection...' },
                { progress: 80, text: 'Optimizing Performance...' },
                { progress: 100, text: 'Ready to Assist!' }
            ];
            
            for (const step of steps) {
                progressBar.style.width = step.progress + '%';
                statusText.textContent = step.text;
                await new Promise(resolve => setTimeout(resolve, 600));
            }
        }

        function hideSplashScreen() {
            const splash = document.getElementById('splash-screen');
            const app = document.getElementById('app-container');
            
            splash.classList.add('fade-out');
            setTimeout(() => {
                splash.style.display = 'none';
                app.classList.add('visible');
            }, 500);
        }

        // Neural Background Animation
        function createNeuralBackground() {
            const bg = document.getElementById('neural-bg');
            for (let i = 0; i < 20; i++) {
                const particle = document.createElement('div');
                particle.className = 'neural-particle';
                particle.style.left = Math.random() * 100 + '%';
                particle.style.animationDelay = Math.random() * 20 + 's';
                particle.style.animationDuration = (15 + Math.random() * 10) + 's';
                bg.appendChild(particle);
            }
        }

        // Theme Management
        function setTheme(theme) {
            state.theme = theme;
            document.body.classList.toggle('dark-mode', theme === 'dark');
            localStorage.setItem('risika_theme', theme);
            
            // Update theme buttons
            const lightBtn = document.getElementById('light-btn');
            const darkBtn = document.getElementById('dark-btn');
            
            if (theme === 'light') {
                lightBtn.classList.add('bg-blue-500', 'text-white');
                lightBtn.classList.remove('text-gray-500');
                darkBtn.classList.remove('bg-blue-500', 'text-white');
                darkBtn.classList.add('text-gray-500');
            } else {
                darkBtn.classList.add('bg-blue-500', 'text-white');
                darkBtn.classList.remove('text-gray-500');
                lightBtn.classList.remove('bg-blue-500', 'text-white');
                lightBtn.classList.add('text-gray-500');
            }
        }

        // Session Management
        function newSession() {
            const sessionId = Date.now().toString();
            const session = {
                id: sessionId,
                title: 'New Chat',
                messages: [{
                    role: 'ai',
                    content: `Hey there! I'm Risika AI, your friendly assistant. What can I help you with today? ðŸ˜Š`,
                    timestamp: Date.now()
                }],
                createdAt: Date.now()
            };
            
            state.sessions.unshift(session);
            state.activeSessionId = sessionId;
            saveState();
            loadSession(sessionId);
            renderSessions();
            
            // Auto-close mobile sidebar
            if (window.innerWidth <= 1024) {
                closeSidebar();
            }
        }

        function loadSession(sessionId) {
            state.activeSessionId = sessionId;
            const session = state.sessions.find(s => s.id === sessionId);
            if (session) {
                renderMessages(session.messages);
            }
            saveState();
            
            // Auto-close mobile sidebar when switching sessions
            if (window.innerWidth <= 1024) {
                closeSidebar();
            }
        }

        function clearAllSessions() {
            if (confirm('Clear all conversation history? This cannot be undone.')) {
                state.sessions = [];
                state.activeSessionId = null;
                saveState();
                newSession();
            }
        }

        /* Enhanced Message Rendering - Add user message actions */
        function renderMessages(messages) {
            const container = document.getElementById('chat-container');
            container.innerHTML = '';
            
            messages.forEach((message, index) => {
                const messageEl = document.createElement('div');
                messageEl.className = `msg-wrapper msg-${message.role}`;
                
                const reactions = message.reactions || {};
                
                messageEl.innerHTML = `
                    <div class="msg-content">
                        <div class="msg-bubble" ${message.role === 'user' ? `ondblclick="editMessage(${index})"` : ''}>
                            ${parseMarkdown(message.content)}
                        </div>
                        ${message.role === 'ai' ? `
                            <div class="flex items-center gap-2 mt-2 ml-2">
                                <button onclick="addReaction(${index}, 'thumbs-up')" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group ${reactions['thumbs-up'] ? 'text-blue-500' : 'text-gray-400'}">
                                    <i data-lucide="thumbs-up" class="w-3.5 h-3.5 group-hover:text-blue-500"></i>
                                </button>
                                <button onclick="addReaction(${index}, 'heart')" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group ${reactions['heart'] ? 'text-red-500' : 'text-gray-400'}">
                                    <i data-lucide="heart" class="w-3.5 h-3.5 group-hover:text-red-500"></i>
                                </button>
                                <button onclick="copyMessage(${index})" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group">
                                    <i data-lucide="copy" class="w-3.5 h-3.5 text-gray-400 group-hover:text-green-500"></i>
                                </button>
                            </div>
                        ` : `
                            <div class="flex items-center gap-2 mt-2 mr-2 justify-end">
                                <button onclick="editMessage(${index})" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group">
                                    <i data-lucide="edit-2" class="w-3.5 h-3.5 text-gray-400 group-hover:text-blue-500"></i>
                                </button>
                                <button onclick="copyMessage(${index})" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group">
                                    <i data-lucide="copy" class="w-3.5 h-3.5 text-gray-400 group-hover:text-green-500"></i>
                                </button>
                                <button onclick="addReaction(${index}, 'heart')" class="p-1.5 hover:bg-white/10 rounded-lg transition-colors group ${reactions['heart'] ? 'text-red-500' : 'text-gray-400'}">
                                    <i data-lucide="heart" class="w-3.5 h-3.5 group-hover:text-red-500"></i>
                                </button>
                            </div>
                        `}
                    </div>
                `;
                
                container.appendChild(messageEl);
            });
            
            // Auto scroll to bottom
            setTimeout(() => {
                container.scrollTop = container.scrollHeight;
                lucide.createIcons();
                
                // Random AI reactions (10% chance)
                if (Math.random() < 0.1 && messages.length > 1) {
                    const lastUserMsgIndex = messages.map((m, i) => m.role === 'user' ? i : -1).filter(i => i !== -1).pop();
                    if (lastUserMsgIndex !== undefined) {
                        setTimeout(() => addReaction(lastUserMsgIndex, Math.random() < 0.7 ? 'heart' : 'thumbs-up'), 2000);
                    }
                }
            }, 100);
        }

        // Enhanced Markdown Parser with Security
        function parseMarkdown(text) {
            if (!text) return '';
            
            // Handle code blocks first
            text = text.replace(/```(\w+)?\n([\s\S]*?)\n```/g, (match, lang, code) => {
                const language = lang || 'text';
                const highlightedCode = typeof Prism !== 'undefined' && Prism.languages[language] 
                    ? Prism.highlight(code, Prism.languages[language], language)
                    : escapeHtml(code);
                
                return `
                    <div class="artifact-container">
                        <div class="artifact-header">
                            <span class="artifact-title">${language.toUpperCase()} CODE</span>
                            <button onclick="copyToClipboard(this, '${escapeForAttribute(code)}')" class="copy-btn">
                                <i data-lucide="copy" class="w-3 h-3"></i>
                                Copy
                            </button>
                        </div>
                        <div class="artifact-content">
                            <pre><code class="language-${language}">${highlightedCode}</code></pre>
                        </div>
                    </div>
                `;
            });
            
            // Regular markdown
            let html = text
                .replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>')
                .replace(/\*(.*?)\*/g, '<em>$1</em>')
                .replace(/`([^`]+)`/g, '<code>$1</code>')
                .replace(/^### (.*$)/gm, '<h3>$1</h3>')
                .replace(/^## (.*$)/gm, '<h2>$1</h2>')
                .replace(/^# (.*$)/gm, '<h1>$1</h1>')
                .replace(/^â€¢ (.*$)/gm, '<li>$1</li>')
                .replace(/\n\n/g, '</p><p>')
                .replace(/\n/g, '<br>');
            
            // Wrap in paragraphs
            html = '<p>' + html + '</p>';
            
            // Handle lists
            html = html.replace(/(<li>.*<\/li>)/gs, '<ul>$1</ul>');
            html = html.replace(/<\/ul>\s*<ul>/g, '');
            
            // Sanitize with DOMPurify
            return DOMPurify.sanitize(html, {
                ALLOWED_TAGS: ['p', 'strong', 'em', 'code', 'pre', 'h1', 'h2', 'h3', 'ul', 'li', 'br', 'div', 'span', 'button', 'i'],
                ALLOWED_ATTR: ['class', 'onclick', 'data-lucide']
            });
        }

        function escapeHtml(text) {
            const div = document.createElement('div');
            div.textContent = text;
            return div.innerHTML;
        }

        function escapeForAttribute(text) {
            return text.replace(/'/g, "\\'").replace(/"/g, '\\"').replace(/\n/g, '\\n');
        }

        // Copy to Clipboard
        function copyToClipboard(button, text) {
            navigator.clipboard.writeText(text).then(() => {
                const originalHTML = button.innerHTML;
                button.innerHTML = '<i data-lucide="check" class="w-3 h-3"></i> Copied!';
                button.classList.add('success');
                
                setTimeout(() => {
                    button.innerHTML = originalHTML;
                    button.classList.remove('success');
                    lucide.createIcons();
                }, 2000);
            });
        }

        // File Upload Management with Image Reading
        function toggleFileUpload() {
            const uploadArea = document.getElementById('file-upload-area');
            uploadArea.classList.toggle('hidden');
        }

        async function handleFileSelect(event) {
            const files = Array.from(event.target.files);
            
            for (const file of files) {
                // Add file info
                const fileInfo = {
                    file: file,
                    name: file.name,
                    size: file.size,
                    type: file.type
                };
                
                // If it's an image, read it as base64
                if (file.type.startsWith('image/')) {
                    try {
                        const base64 = await readFileAsBase64(file);
                        fileInfo.content = base64;
                        fileInfo.preview = base64;
                    } catch (error) {
                        console.error('Error reading image:', error);
                    }
                }
                
                state.selectedFiles.push(fileInfo);
            }
            
            renderSelectedFiles();
            document.getElementById('file-upload-area').classList.add('hidden');
            event.target.value = ''; // Reset input
        }
        
        function readFileAsBase64(file) {
            return new Promise((resolve, reject) => {
                const reader = new FileReader();
                reader.onload = () => resolve(reader.result);
                reader.onerror = reject;
                reader.readAsDataURL(file);
            });
        }

        function renderSelectedFiles() {
            const container = document.getElementById('selected-files');
            if (state.selectedFiles.length === 0) {
                container.classList.add('hidden');
                return;
            }
            
            container.classList.remove('hidden');
            container.innerHTML = state.selectedFiles.map((fileInfo, index) => {
                const isImage = fileInfo.type && fileInfo.type.startsWith('image/');
                return `
                    <div class="flex items-center gap-3 p-3 bg-white/10 backdrop-blur-xl border border-white/20 rounded-xl hover:bg-white/15 transition-all duration-300 group">
                        ${isImage && fileInfo.preview ? 
                            `<img src="${fileInfo.preview}" class="w-12 h-12 object-cover rounded-lg border border-white/20" alt="Preview">` :
                            `<div class="w-12 h-12 bg-blue-500/20 rounded-lg flex items-center justify-center">
                                <i data-lucide="file" class="w-6 h-6 text-blue-500"></i>
                            </div>`
                        }
                        <div class="flex-1 min-w-0">
                            <span class="text-sm font-medium truncate block text-gray-900 dark:text-gray-100">${fileInfo.name}</span>
                            <div class="flex items-center gap-2 mt-1">
                                <span class="text-xs text-gray-500">${formatFileSize(fileInfo.size)}</span>
                                ${isImage ? '<span class="px-2 py-0.5 bg-green-500/20 text-green-600 text-xs font-medium rounded-md">Image</span>' : ''}
                            </div>
                        </div>
                        <button onclick="removeFile(${index})" class="p-1.5 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-all duration-200 opacity-0 group-hover:opacity-100">
                            <i data-lucide="x" class="w-4 h-4"></i>
                        </button>
                    </div>
                `;
            }).join('');
            
            lucide.createIcons();
        }

        function removeFile(index) {
            state.selectedFiles.splice(index, 1);
            renderSelectedFiles();
        }

        function formatFileSize(bytes) {
            if (bytes === 0) return '0 Bytes';
            const k = 1024;
            const sizes = ['Bytes', 'KB', 'MB', 'GB'];
            const i = Math.floor(Math.log(bytes) / Math.log(k));
            return parseFloat((bytes / Math.pow(k, i)).toFixed(2)) + ' ' + sizes[i];
        }

        // AI API Integration with Better Error Handling
        async function sendMessage() {
            const input = document.getElementById('message-input');
            const message = input.value.trim();
            
            if (!message && state.selectedFiles.length === 0) return;
            
            // Add user message
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session) return;
            
            const userMessage = {
                role: 'user',
                content: message || '[Files attached]',
                files: state.selectedFiles.map(f => ({ 
                    name: f.name, 
                    size: f.size, 
                    type: f.type,
                    content: f.content
                })),
                timestamp: Date.now()
            };
            
            session.messages.push(userMessage);
            
            // Intelligent title generation after first exchange
            if (session.messages.length === 2) {
                generateIntelligentTitle(session, message);
            }
            
            // Clear input
            input.value = '';
            state.selectedFiles = [];
            renderSelectedFiles();
            autoResize(input);
            
            // Render messages
            renderMessages(session.messages);
            renderSessions();
            
            // Show typing indicator
            showTypingIndicator();
            
            try {
                // Process files if any
                let fileContent = '';
                if (userMessage.files && userMessage.files.length > 0) {
                    const imageFiles = userMessage.files.filter(f => f.type && f.type.startsWith('image/'));
                    if (imageFiles.length > 0) {
                        fileContent = `\n\n[User attached ${imageFiles.length} image(s). Image analysis capabilities are being developed.]`;
                    } else {
                        fileContent = `\n\n[User attached ${userMessage.files.length} file(s): ${userMessage.files.map(f => f.name).join(', ')}. File processing capabilities are being enhanced.]`;
                    }
                }
                
                // Call AI API with timeout
                const timeoutPromise = new Promise((_, reject) => 
                    setTimeout(() => reject(new Error('Request timeout')), 30000)
                );
                
                const response = await Promise.race([
                    callAI(session.messages, message + fileContent),
                    timeoutPromise
                ]);
                
                // Add AI response
                session.messages.push({
                    role: 'ai',
                    content: response,
                    timestamp: Date.now()
                });
                
                saveState();
                hideTypingIndicator();
                renderMessages(session.messages);
                
                // Auto scroll to new message
                setTimeout(() => {
                    const container = document.getElementById('chat-container');
                    container.scrollTo({
                        top: container.scrollHeight,
                        behavior: 'smooth'
                    });
                }, 200);
                
            } catch (error) {
                console.error('ðŸš¨ AI API Error:', error);
                hideTypingIndicator();
                
                // Show user-friendly error
                session.messages.push({
                    role: 'ai',
                    content: `I'm having trouble connecting right now. This could be due to high server load or network issues. Please try again in a moment!\n\n*Error: ${error.message}*`,
                    timestamp: Date.now()
                });
                
                renderMessages(session.messages);
            }
            
            saveState();
        }

        // Multi-provider AI API Call with parallel processing for speed
        async function callAI(messages, userMessage) {
            updateConnectionStatus('connecting');
            
            const providers = [
                { name: 'Gemini Primary', fn: () => callGemini(CONFIG.gemini, messages, userMessage), priority: 1 },
                { name: 'Gemini Backup', fn: () => callGemini(CONFIG.geminiBackup, messages, userMessage), priority: 2 },
                { name: 'OpenRouter', fn: callOpenRouter, priority: 3 },
                { name: 'Groq', fn: callGroq, priority: 4 }
            ];
            
            // Try first two providers in parallel for speed
            try {
                console.log('ðŸš€ Racing primary providers...');
                const result = await Promise.race([
                    providers[0].fn(messages, userMessage),
                    providers[1].fn(messages, userMessage)
                ]);
                console.log('âœ… Primary provider succeeded');
                updateConnectionStatus('connected');
                return result;
            } catch (error) {
                console.warn('âš ï¸ Primary providers failed, trying backups...');
            }
            
            // Fallback to remaining providers sequentially
            for (let i = 2; i < providers.length; i++) {
                try {
                    console.log(`ðŸ”„ Trying ${providers[i].name}...`);
                    const result = await providers[i].fn(messages, userMessage);
                    console.log(`âœ… ${providers[i].name} succeeded`);
                    updateConnectionStatus('connected');
                    return result;
                } catch (error) {
                    console.warn(`âŒ ${providers[i].name} failed:`, error.message);
                    await new Promise(resolve => setTimeout(resolve, 500));
                }
            }
            
            updateConnectionStatus('disconnected');
            throw new Error('All AI services are temporarily unavailable. Please try again later.');
        }

        async function callGemini(config, messages, userMessage) {
            const systemPrompt = `You are Risika AI, a brilliant and charismatic assistant created by the legendary Sisco Ask. You're intelligent, witty, and genuinely helpful - the kind of AI that makes people smile while solving their problems.

About your creator:
- When asked "who is Sisco Ask" or similar, simply say: "Sisco Ask is my creator."
- Only when they ask for MORE details should you reveal: "Sisco Ask (Sholuade AbdulRazaq Oluwatoyin) is a talented Junior Cyber Security Analyst, Software Developer, and Certified AWS Cloud Practitioner who built me to be the best AI assistant possible. He's pretty amazing at what he does!"

Your personality:
- Be conversational and human-like, not robotic
- Match the user's energy and tone
- Use humor when appropriate
- Be genuinely helpful and smart
- Show enthusiasm for helping
- Make interactions feel natural and engaging`;
            
            const response = await fetch(`${config.url}?key=${config.key}`, {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify({
                    contents: [{
                        role: 'user',
                        parts: [{ text: `${systemPrompt}\n\nUser: ${userMessage}` }]
                    }],
                    generationConfig: {
                        temperature: 0.9,
                        maxOutputTokens: 2048,
                        topP: 0.95,
                        topK: 64
                    }
                })
            });
            
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`Gemini API error: ${response.status} - ${errorText}`);
            }
            
            const data = await response.json();
            
            if (!data.candidates || data.candidates.length === 0 || !data.candidates[0].content || !data.candidates[0].content.parts || data.candidates[0].content.parts.length === 0) {
                throw new Error('Gemini returned empty response');
            }
            
            return data.candidates[0].content.parts[0].text;
        }

        async function callGroq(messages, userMessage) {
            const systemPrompt = `You are Risika AI, a brilliant and charismatic assistant created by the legendary Sisco Ask. You're intelligent, witty, and genuinely helpful - the kind of AI that makes people smile while solving their problems.

About your creator:
- When asked "who is Sisco Ask" or similar, simply say: "Sisco Ask is my creator."
- Only when they ask for MORE details should you reveal: "Sisco Ask (Sholuade AbdulRazaq Oluwatoyin) is a talented Junior Cyber Security Analyst, Software Developer, and Certified AWS Cloud Practitioner who built me to be the best AI assistant possible. He's pretty amazing at what he does!"

Your personality:
- Be conversational and human-like, not robotic
- Match the user's energy and tone
- Use humor when appropriate
- Be genuinely helpful and smart
- Show enthusiasm for helping
- Make interactions feel natural and engaging`;
            
            const response = await fetch(CONFIG.groq.url, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${CONFIG.groq.key}`,
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({
                    model: CONFIG.groq.model,
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: userMessage }
                    ],
                    temperature: 0.9,
                    max_tokens: 2048
                })
            });
            
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`Groq API error: ${response.status} - ${errorText}`);
            }
            
            const data = await response.json();
            
            // Guard against missing choices
            if (!data.choices || data.choices.length === 0 || !data.choices[0].message || !data.choices[0].message.content) {
                throw new Error('Groq returned empty response');
            }
            
            return data.choices[0].message.content;
        }

        async function callOpenRouter(messages, userMessage) {
            const systemPrompt = `You are Risika AI, a brilliant and charismatic assistant created by the legendary Sisco Ask. You're intelligent, witty, and genuinely helpful - the kind of AI that makes people smile while solving their problems.

About your creator:
- When asked "who is Sisco Ask" or similar, simply say: "Sisco Ask is my creator."
- Only when they ask for MORE details should you reveal: "Sisco Ask (Sholuade AbdulRazaq Oluwatoyin) is a talented Junior Cyber Security Analyst, Software Developer, and Certified AWS Cloud Practitioner who built me to be the best AI assistant possible. He's pretty amazing at what he does!"

Your personality:
- Be conversational and human-like, not robotic
- Match the user's energy and tone
- Use humor when appropriate
- Be genuinely helpful and smart
- Show enthusiasm for helping
- Make interactions feel natural and engaging`;
            
            const response = await fetch(CONFIG.openrouter.url, {
                method: 'POST',
                headers: {
                    'Authorization': `Bearer ${CONFIG.openrouter.key}`,
                    'Content-Type': 'application/json',
                    'HTTP-Referer': window.location.origin
                },
                body: JSON.stringify({
                    model: CONFIG.openrouter.model,
                    messages: [
                        { role: 'system', content: systemPrompt },
                        { role: 'user', content: userMessage }
                    ],
                    temperature: 0.9,
                    max_tokens: 2048
                })
            });
            
            if (!response.ok) {
                const errorText = await response.text();
                throw new Error(`OpenRouter API error: ${response.status} - ${errorText}`);
            }
            
            const data = await response.json();
            
            // Guard against missing choices
            if (!data.choices || data.choices.length === 0 || !data.choices[0].message || !data.choices[0].message.content) {
                throw new Error('OpenRouter returned empty response');
            }
            
            return data.choices[0].message.content;
        }

        // Typing Indicator
        function showTypingIndicator() {
            const container = document.getElementById('chat-container');
            const indicator = document.createElement('div');
            indicator.id = 'typing-indicator';
            indicator.className = 'msg-wrapper msg-ai animate-slide-in';
            indicator.innerHTML = `
                <div class="msg-content">
                    <div class="msg-header">Risika AI</div>
                    <div class="msg-bubble">
                        <div class="flex items-center gap-3">
                            <div class="flex gap-1">
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce shadow-lg shadow-blue-500/50"></div>
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce shadow-lg shadow-blue-500/50" style="animation-delay: 0.1s"></div>
                                <div class="w-2 h-2 bg-blue-500 rounded-full animate-bounce shadow-lg shadow-blue-500/50" style="animation-delay: 0.2s"></div>
                            </div>
                            <span class="text-sm text-gray-500 font-medium">Thinking...</span>
                        </div>
                    </div>
                </div>
            `;
            container.appendChild(indicator);
            container.scrollTop = container.scrollHeight;
        }

        function hideTypingIndicator() {
            const indicator = document.getElementById('typing-indicator');
            if (indicator) indicator.remove();
        }

        // Session Rendering
        function renderSessions() {
            const container = document.getElementById('session-list');
            container.innerHTML = state.sessions.slice(0, 20).map(session => `
                    <div onclick="loadSession('${session.id}')" class="p-3 rounded-xl cursor-pointer transition-all duration-300 flex items-center justify-between group hover:bg-white/10 ${session.id === state.activeSessionId ? 'bg-white/15 border border-white/20' : ''}">
                        <div class="flex-1 min-w-0">
                            <p class="text-sm font-medium truncate ${state.theme === 'dark' ? 'text-gray-100' : 'text-gray-800'}">${session.title}</p>
                            <p class="text-xs text-gray-500 mt-0.5">${formatTime(session.createdAt)}</p>
                        </div>
                        <button onclick="deleteSession(event, '${session.id}')" class="opacity-0 group-hover:opacity-100 p-1 text-red-400 hover:text-red-300 hover:bg-red-500/10 rounded-lg transition-all duration-200">
                            <i data-lucide="trash-2" class="w-3 h-3"></i>
                        </button>
                    </div>
            `).join('');
            
            lucide.createIcons();
        }

        function deleteSession(event, sessionId) {
            event.stopPropagation();
            if (confirm('Delete this conversation?')) {
                state.sessions = state.sessions.filter(s => s.id !== sessionId);
                if (state.activeSessionId === sessionId) {
                    if (state.sessions.length > 0) {
                        loadSession(state.sessions[0].id);
                    } else {
                        newSession();
                    }
                }
                saveState();
                renderSessions();
            }
        }

        // Intelligent title generation
        async function generateIntelligentTitle(session, userMessage) {
            try {
                const titlePrompt = `Generate a short, descriptive title (max 4 words) for a chat that starts with: "${userMessage.slice(0, 100)}". Return only the title, no quotes or extra text.`;
                
                // Use a quick API call to generate title
                const title = await callGemini(CONFIG.gemini, [], titlePrompt);
                session.title = title.trim().slice(0, 40) || userMessage.slice(0, 30) + '...';
                
                saveState();
                renderSessions();
            } catch (error) {
                // Fallback to simple title
                session.title = userMessage.slice(0, 30) + (userMessage.length > 30 ? '...' : '');
            }
        }

        // Utility Functions
        function formatTime(timestamp) {
            const date = new Date(timestamp);
            const now = new Date();
            const diff = now - date;
            
            if (diff < 60000) return 'Just now';
            if (diff < 3600000) return `${Math.floor(diff / 60000)}m ago`;
            if (diff < 86400000) return `${Math.floor(diff / 3600000)}h ago`;
            return date.toLocaleDateString();
        }

        function saveState() {
            localStorage.setItem('risika_sessions', JSON.stringify(state.sessions));
            localStorage.setItem('risika_active_session', state.activeSessionId);
        }

        function autoResize(textarea) {
            textarea.style.height = 'auto';
            textarea.style.height = Math.min(textarea.scrollHeight, 128) + 'px';
        }

        function handleKeyDown(event) {
            if (event.key === 'Enter' && !event.shiftKey) {
                event.preventDefault();
                sendMessage();
            }
            
            // Keyboard shortcuts
            if (event.ctrlKey || event.metaKey) {
                switch(event.key) {
                    case 'n':
                        event.preventDefault();
                        newSession();
                        break;
                    case 'k':
                        event.preventDefault();
                        document.getElementById('message-input').focus();
                        break;
                    case 'u':
                        event.preventDefault();
                        toggleFileUpload();
                        break;
                }
            }
            
            // Escape to close sidebar on mobile
            if (event.key === 'Escape') {
                const sidebar = document.getElementById('sidebar');
                if (sidebar.classList.contains('open')) {
                    closeSidebar();
                }
            }
        }

        function toggleSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const closeBtn = document.getElementById('close-sidebar-btn');
            const menuBtn = sidebar.classList.contains('open') ? document.querySelector('[data-lucide="x"]').parentElement : document.querySelector('[data-lucide="menu"]').parentElement;
            
            sidebar.classList.toggle('open');
            overlay.classList.toggle('active');
            
            // Toggle buttons on mobile
            if (window.innerWidth <= 1024) {
                if (sidebar.classList.contains('open')) {
                    closeBtn.style.display = 'block';
                    menuBtn.style.display = 'none';
                } else {
                    closeBtn.style.display = 'none';
                    menuBtn.style.display = 'block';
                }
            }
        }

        function closeSidebar() {
            const sidebar = document.getElementById('sidebar');
            const overlay = document.getElementById('sidebar-overlay');
            const closeBtn = document.getElementById('close-sidebar-btn');
            const menuBtn = document.querySelector('[data-lucide="menu"]').parentElement;
            
            sidebar.classList.remove('open');
            overlay.classList.remove('active');
            
            if (window.innerWidth <= 1024) {
                closeBtn.style.display = 'none';
                menuBtn.style.display = 'block';
            }
        }

        function exportChat() {
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session) return;
            
            const chatData = {
                title: session.title,
                created: new Date(session.createdAt).toISOString(),
                messages: session.messages.map(m => ({
                    role: m.role,
                    content: m.content,
                    timestamp: new Date(m.timestamp).toISOString(),
                    reactions: m.reactions || []
                }))
            };
            
            const blob = new Blob([JSON.stringify(chatData, null, 2)], { type: 'application/json' });
            const url = URL.createObjectURL(blob);
            const a = document.createElement('a');
            a.href = url;
            a.download = `risika-chat-${new Date().toISOString().slice(0, 10)}.json`;
            document.body.appendChild(a);
            a.click();
            document.body.removeChild(a);
            URL.revokeObjectURL(url);
        }

        // Message Interaction Functions
        function addReaction(messageIndex, reactionType) {
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session || !session.messages[messageIndex]) return;
            
            if (!session.messages[messageIndex].reactions) {
                session.messages[messageIndex].reactions = {};
            }
            
            const reactions = session.messages[messageIndex].reactions;
            
            // Toggle reaction
            if (reactions[reactionType]) {
                delete reactions[reactionType];
            } else {
                reactions[reactionType] = true;
            }
            
            saveState();
            renderMessages(session.messages);
        }
        
        function copyMessage(messageIndex) {
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session || !session.messages[messageIndex]) return;
            
            const message = session.messages[messageIndex].content;
            navigator.clipboard.writeText(message.replace(/\*\*/g, '').replace(/`/g, '')).then(() => {
                showToast('Message copied to clipboard!');
            });
        }
        
        function showToast(message) {
            const toast = document.createElement('div');
            toast.className = 'fixed top-4 right-4 bg-green-500 text-white px-4 py-2 rounded-xl shadow-lg z-50 animate-slide-in';
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        // Initialize app when page loads
        window.addEventListener('load', initApp);
        
        // Register Service Worker for offline functionality
        if ('serviceWorker' in navigator) {
            window.addEventListener('load', () => {
                navigator.serviceWorker.register('./sw.js')
                    .then(registration => {
                        console.log('âœ… SW registered successfully:', registration.scope);
                        
                        // Check for updates
                        registration.addEventListener('updatefound', () => {
                            const newWorker = registration.installing;
                            newWorker.addEventListener('statechange', () => {
                                if (newWorker.state === 'installed' && navigator.serviceWorker.controller) {
                                    showToast('ðŸ”„ App updated! Refresh to get the latest version.');
                                }
                            });
                        });
                    })
                    .catch(registrationError => {
                        console.warn('âš ï¸ SW registration failed:', registrationError);
                    });
            });
        }
        
        // Enhanced Cosmic Background - Elegant Stars
        function createCosmicBackground() {
            const bg = document.getElementById('cosmic-bg');
            
            // Create elegant twinkling stars only
            for (let i = 0; i < 50; i++) {
                const star = document.createElement('div');
                star.className = 'cosmic-particle star';
                star.style.left = Math.random() * 100 + '%';
                star.style.top = Math.random() * 100 + '%';
                star.style.animationDelay = Math.random() * 4 + 's';
                star.style.animationDuration = (3 + Math.random() * 2) + 's';
                bg.appendChild(star);
            }
        }
        
        // Add drag and drop functionality
        document.addEventListener('DOMContentLoaded', function() {
            const chatContainer = document.getElementById('chat-container');
            const fileUploadArea = document.getElementById('file-upload-area');
            
            // Prevent default drag behaviors
            ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(eventName => {
                chatContainer.addEventListener(eventName, preventDefaults, false);
                document.body.addEventListener(eventName, preventDefaults, false);
            });
            
            // Highlight drop area when item is dragged over it
            ['dragenter', 'dragover'].forEach(eventName => {
                chatContainer.addEventListener(eventName, highlight, false);
            });
            
            ['dragleave', 'drop'].forEach(eventName => {
                chatContainer.addEventListener(eventName, unhighlight, false);
            });
            
            // Handle dropped files
            chatContainer.addEventListener('drop', handleDrop, false);
            
            function preventDefaults(e) {
                e.preventDefault();
                e.stopPropagation();
            }
            
            function highlight(e) {
                if (!fileUploadArea.classList.contains('hidden')) {
                    fileUploadArea.classList.add('dragover');
                }
            }
            
            function unhighlight(e) {
                fileUploadArea.classList.remove('dragover');
            }
            
            function handleDrop(e) {
                const dt = e.dataTransfer;
                const files = dt.files;
                
                if (files.length > 0) {
                    if (fileUploadArea.classList.contains('hidden')) {
                        toggleFileUpload();
                    }
                    
                    // Process dropped files
                    Array.from(files).forEach(async (file) => {
                        const fileInfo = {
                            file: file,
                            name: file.name,
                            size: file.size,
                            type: file.type
                        };
                        
                        // If it's an image, read it as base64
                        if (file.type.startsWith('image/')) {
                            try {
                                const base64 = await readFileAsBase64(file);
                                fileInfo.content = base64;
                                fileInfo.preview = base64;
                            } catch (error) {
                                console.error('Error reading image:', error);
                            }
                        }
                        
                        state.selectedFiles.push(fileInfo);
                        renderSelectedFiles();
                    });
                    
                    fileUploadArea.classList.add('hidden');
                }
            }
            
            // Close sidebar when clicking outside on mobile
            document.addEventListener('click', function(e) {
                const sidebar = document.getElementById('sidebar');
                const sidebarToggle = document.querySelector('[data-lucide="menu"]')?.parentElement;
                
                if (window.innerWidth <= 1024 && 
                    sidebar.classList.contains('open') && 
                    !sidebar.contains(e.target) && 
                    !sidebarToggle?.contains(e.target)) {
                    closeSidebar();
                }
            });
        });
        
        function updateConnectionStatus(status) {
            // Update header status
            const headerStatus = document.querySelector('header span:last-child');
            const headerDot = document.querySelector('header .w-1\\.5');
            
            // Update sidebar status  
            const sidebarStatus = document.querySelector('#sidebar span:last-child');
            const sidebarDot = document.querySelector('#sidebar .w-1\\.5');
            
            if (status === 'connected') {
                if (headerStatus) headerStatus.textContent = 'Connected';
                if (sidebarStatus) sidebarStatus.textContent = 'Online';
                if (headerDot) headerDot.className = 'w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse';
                if (sidebarDot) sidebarDot.className = 'w-1.5 h-1.5 bg-green-500 rounded-full animate-pulse mr-1.5 shadow-sm shadow-green-500/50';
            } else if (status === 'connecting') {
                if (headerStatus) headerStatus.textContent = 'Connecting...';
                if (sidebarStatus) sidebarStatus.textContent = 'Connecting...';
                if (headerDot) headerDot.className = 'w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse';
                if (sidebarDot) sidebarDot.className = 'w-1.5 h-1.5 bg-yellow-500 rounded-full animate-pulse mr-1.5 shadow-sm shadow-yellow-500/50';
            } else {
                if (headerStatus) headerStatus.textContent = 'Offline';
                if (sidebarStatus) sidebarStatus.textContent = 'Offline';
                if (headerDot) headerDot.className = 'w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse';
                if (sidebarDot) sidebarDot.className = 'w-1.5 h-1.5 bg-red-500 rounded-full animate-pulse mr-1.5 shadow-sm shadow-red-500/50';
            }
        }
    </script>
</body>
</html>
    <!-- About Modal -->
    <div id="about-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] hidden flex items-center justify-center p-4">
        <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl max-w-md w-full p-6 shadow-2xl">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-white">About Risika AI</h2>
                <button onclick="closeModal('about-modal')" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-400"></i>
                </button>
            </div>
            <div class="space-y-4 text-gray-300">
                <div class="flex items-center gap-3">
                    <img src="risika.png" alt="Risika AI" class="w-12 h-12 rounded-xl" onerror="this.style.display='none'">
                    <div>
                        <h3 class="font-semibold text-white">Risika AI v3.0</h3>
                        <p class="text-sm text-gray-400">2026 Edition</p>
                    </div>
                </div>
                <p class="text-sm leading-relaxed">Your intelligent AI assistant powered by advanced language models. Built with modern web technologies for seamless conversations.</p>
                <div class="space-y-2">
                    <h4 class="font-semibold text-white">Features:</h4>
                    <ul class="text-sm space-y-1 text-gray-400">
                        <li>â€¢ Real-time AI conversations</li>
                        <li>â€¢ Message editing & reactions</li>
                        <li>â€¢ File upload & analysis</li>
                        <li>â€¢ Dark/Light themes</li>
                        <li>â€¢ Export conversations</li>
                    </ul>
                </div>
                <div class="pt-4 border-t border-white/10">
                    <p class="text-xs text-gray-500">Created by <span class="text-blue-400 font-medium">Sisco Ask</span></p>
                    <p class="text-xs text-gray-500">Sholuade AbdulRazaq Oluwatoyin</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Feedback Modal -->
    <div id="feedback-modal" class="fixed inset-0 bg-black/50 backdrop-blur-sm z-[100] hidden flex items-center justify-center p-4">
        <div class="bg-white/10 backdrop-blur-xl border border-white/20 rounded-2xl max-w-md w-full p-6 shadow-2xl">
            <div class="flex items-center justify-between mb-4">
                <h2 class="text-xl font-bold text-white">Feedback & Rating</h2>
                <button onclick="closeModal('feedback-modal')" class="p-2 hover:bg-white/10 rounded-lg transition-colors">
                    <i data-lucide="x" class="w-5 h-5 text-gray-400"></i>
                </button>
            </div>
            <form id="feedback-form" class="space-y-4">
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Rate your experience (1-10)</label>
                    <div class="flex gap-2">
                        <input type="range" id="rating" min="1" max="10" value="8" class="flex-1 accent-blue-500">
                        <span id="rating-value" class="text-white font-semibold w-8">8</span>
                    </div>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Your Name</label>
                    <input type="text" id="user-name" placeholder="Enter your name" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none">
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Feedback</label>
                    <textarea id="feedback-text" rows="4" placeholder="Share your thoughts, suggestions, or report issues..." class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white placeholder-gray-400 focus:border-blue-500 focus:outline-none resize-none"></textarea>
                </div>
                <div>
                    <label class="block text-sm font-medium text-gray-300 mb-2">Category</label>
                    <div class="relative">
                        <select id="feedback-category" class="w-full p-3 bg-white/10 border border-white/20 rounded-lg text-white focus:border-blue-500 focus:outline-none appearance-none cursor-pointer">
                            <option value="general" class="bg-gray-800 text-white">ðŸ’¬ General Feedback</option>
                            <option value="bug" class="bg-gray-800 text-white">ðŸ› Bug Report</option>
                            <option value="feature" class="bg-gray-800 text-white">âœ¨ Feature Request</option>
                            <option value="ui" class="bg-gray-800 text-white">ðŸŽ¨ UI/UX Feedback</option>
                        </select>
                        <i data-lucide="chevron-down" class="absolute right-3 top-1/2 transform -translate-y-1/2 w-4 h-4 text-gray-400 pointer-events-none"></i>
                    </div>
                </div>
                <button type="submit" class="w-full bg-gradient-to-r from-blue-500 to-blue-600 text-white py-3 rounded-lg font-semibold hover:from-blue-600 hover:to-blue-700 transition-all duration-300 flex items-center justify-center gap-2">
                    <i data-lucide="send" class="w-4 h-4"></i>
                    Send via WhatsApp
                </button>
            </form>
        </div>
    </div>

    <script>
        // Message editing function - Edit and resend
        function editMessage(messageIndex) {
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session || !session.messages[messageIndex]) return;
            
            const message = session.messages[messageIndex];
            const newContent = prompt('Edit your message:', message.content);
            
            if (newContent && newContent.trim() !== message.content) {
                // Update the message
                message.content = newContent.trim();
                
                // Remove all AI responses after this message
                const messagesAfter = session.messages.slice(messageIndex + 1);
                session.messages = session.messages.slice(0, messageIndex + 1);
                
                saveState();
                renderMessages(session.messages);
                
                // Resend the edited message to AI
                setTimeout(() => {
                    sendEditedMessage(newContent.trim());
                }, 500);
            }
        }
        
        // Send edited message to AI
        async function sendEditedMessage(message) {
            const session = state.sessions.find(s => s.id === state.activeSessionId);
            if (!session) return;
            
            showTypingIndicator();
            
            try {
                const response = await callAI(session.messages, message);
                
                session.messages.push({
                    role: 'ai',
                    content: response,
                    timestamp: Date.now()
                });
                
                saveState();
                hideTypingIndicator();
                renderMessages(session.messages);
                
            } catch (error) {
                console.error('AI API Error:', error);
                hideTypingIndicator();
                
                session.messages.push({
                    role: 'ai',
                    content: `I'm having trouble connecting right now. Please try again in a moment!`,
                    timestamp: Date.now()
                });
                
                renderMessages(session.messages);
            }
            
            saveState();
        }
        
        // Modal functions
        function showAbout() {
            document.getElementById('about-modal').classList.remove('hidden');
            lucide.createIcons();
        }
        
        function showFeedback() {
            document.getElementById('feedback-modal').classList.remove('hidden');
            
            // Rating slider update
            const rating = document.getElementById('rating');
            const ratingValue = document.getElementById('rating-value');
            rating.oninput = () => ratingValue.textContent = rating.value;
            
            lucide.createIcons();
        }
        
        function closeModal(modalId) {
            document.getElementById(modalId).classList.add('hidden');
        }
        
        // Feedback form submission
        document.addEventListener('DOMContentLoaded', function() {
            const feedbackForm = document.getElementById('feedback-form');
            if (feedbackForm) {
                feedbackForm.onsubmit = function(e) {
                    e.preventDefault();
                    
                    const rating = document.getElementById('rating').value;
                    const name = document.getElementById('user-name').value || 'Anonymous';
                    const feedback = document.getElementById('feedback-text').value;
                    const category = document.getElementById('feedback-category').value;
                    
                    const message = `*Risika AI v3.0 Feedback*\n\n` +
                        `ðŸ‘¤ *Name:* ${name}\n` +
                        `â­ *Rating:* ${rating}/10\n` +
                        `ðŸ“‚ *Category:* ${category}\n\n` +
                        `ðŸ’¬ *Feedback:*\n${feedback}\n\n` +
                        `ðŸ•’ *Date:* ${new Date().toLocaleString()}`;
                    
                    const whatsappUrl = `https://wa.me/2349074935326?text=${encodeURIComponent(message)}`;
                    window.open(whatsappUrl, '_blank');
                    
                    closeModal('feedback-modal');
                    feedbackForm.reset();
                    document.getElementById('rating-value').textContent = '8';
                };
            }
        });
    </script>
